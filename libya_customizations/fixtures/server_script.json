[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Submit",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.858538",
  "module": "Libya Customizations",
  "name": "change status on submit sales order",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Order",
  "script": "doc.custom_status = \"Submitted\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Cancel",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.714537",
  "module": "Libya Customizations",
  "name": "change status on cancel sales order",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Order",
  "script": "doc.custom_status = \"Cancelled\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Submit",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.450120",
  "module": "Libya Customizations",
  "name": "change status on submit delivery note",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Delivery Note",
  "script": "doc.custom_status = \"Submitted\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Submit",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.366043",
  "module": "Libya Customizations",
  "name": "change status on submit sales invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "doc.custom_status = \"Submitted\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Cancel",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.604654",
  "module": "Libya Customizations",
  "name": "change status on cancel sales invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "doc.custom_status = \"Cancelled\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Cancel",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.527375",
  "module": "Libya Customizations",
  "name": "change status on cancel delivery note",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Delivery Note",
  "script": "doc.custom_status = \"Cancelled\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.266012",
  "module": "Libya Customizations",
  "name": "Sales Order - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Order",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabSales Order`.name NOT IN (SELECT amended_from FROM `tabSales Order` WHERE amended_from IS NOT NULL)\"\n\nif frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Warehouse User\"]]):\n    conditions = \"docstatus=1 AND reservation_status='Reserve with Delivery'AND delivery_status IN ('Not Delivered', 'Partly Delivered')\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.178893",
  "module": "Libya Customizations",
  "name": "Delivery Note - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Delivery Note",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabDelivery Note`.name NOT IN (SELECT amended_from FROM `tabDelivery Note` WHERE amended_from IS NOT NULL)\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.030672",
  "module": "Libya Customizations",
  "name": "Sales Invoice - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions=\"is_opening='No'\"\n\nif not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabSales Invoice`.name NOT IN (SELECT amended_from FROM `tabSales Invoice` WHERE amended_from IS NOT NULL)\"\n\nif frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Warehouse User\"]]):\n    conditions = \"is_return=1 AND workflow_state IN ('Pending Submission', 'Returned', 'Rejected Submission', 'Pending Cancellation', 'Discarded', 'Rejected Cancellation')\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 10:00:37.969638",
  "module": "Libya Customizations",
  "name": "Account - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Account",
  "script": "if frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Libya Team\"]]):\n    conditions = \"restrict_account_view='No'\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:06.103992",
  "module": "Libya Customizations",
  "name": "Item Price - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Item Price",
  "script": "if frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Libya Team\"]]):\n    conditions = \"selling=1\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.986576",
  "module": "Libya Customizations",
  "name": "Receipt Voucher - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Receipt Voucher",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabReceipt Voucher`.name NOT IN (SELECT amended_from FROM `tabReceipt Voucher` WHERE amended_from IS NOT NULL)\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.886717",
  "module": "Libya Customizations",
  "name": "Payment Voucher - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Payment Voucher",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabPayment Voucher`.name NOT IN (SELECT amended_from FROM `tabPayment Voucher` WHERE amended_from IS NOT NULL)\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.810268",
  "module": "Libya Customizations",
  "name": "Transfer Voucher - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Transfer Voucher",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabTransfer Voucher`.name NOT IN (SELECT amended_from FROM `tabTransfer Voucher` WHERE amended_from IS NOT NULL)\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.701022",
  "module": "Libya Customizations",
  "name": "Debt Voucher - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Debt Voucher",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabDebt Voucher`.name NOT IN (SELECT amended_from FROM `tabDebt Voucher` WHERE amended_from IS NOT NULL)\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.462582",
  "module": "Libya Customizations",
  "name": "Clearing Voucher - Permission Query",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Clearing Voucher",
  "script": "if not frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"System Manager\"]]):\n    conditions = \"`tabClearing Voucher`.name NOT IN (SELECT amended_from FROM `tabClearing Voucher` WHERE amended_from IS NOT NULL)\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Save (Submitted Document)",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.154078",
  "module": "Libya Customizations",
  "name": "Update Remarks in Sales Invoice (After Submit)",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "delivery_note = doc.items[0].delivery_note\ntext = \"\"\nif doc.is_return:\n    if doc.is_paid:\n        text = 'فاتورة مردودات مبيعات نقدية'\n    else:\n        text = 'فاتورة مردودات مبيعات آجلة'\nelse:\n    if doc.is_paid:\n        text = f'فاتورة مبيعات نقدية من إذن تسليم رقم {delivery_note}'\n    else:\n        text = f'فاتورة مبيعات آجلة من إذن تسليم رقم {delivery_note}'\n        \nfrappe.db.set_value('Sales Invoice', doc.name, 'remarks', text)\nfrappe.db.set_value('GL Entry', {\"voucher_type\":\"Sales Invoice\", \"voucher_no\": doc.name}, 'remarks', text)\n    ",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Submit",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 14:25:12.282952",
  "module": "Libya Customizations",
  "name": "Auto-Creation of Purchase Receipt Upon Submitting Purchase Invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Purchase Invoice",
  "script": "items_to_load = []\nfor item in doc.items:\n    items_to_load.append({\n        'item_code': item.item_code,\n        'qty': item.qty,\n        'received_qty': item.qty,\n        'purchase_order': item.purchase_order,\n        'purchase_order_item': item.po_detail,\n        'purchase_invoice': doc.name,\n        'purchase_invoice_item': item.name,\n        'warehouse': frappe.db.get_value('Stock Settings', 'Stock Settings', 'default_warehouse'),\n        'rate': item.rate,\n        'price_list_rate': item.price_list_rate,\n        'expense_account': frappe.db.get_value('Company', doc.company, \"stock_received_but_not_billed\")\n    })\nif not (doc.is_return and doc.update_stock):\n    frappe.get_doc(dict(\n    doctype = 'Purchase Receipt',\n    title = doc.title,\n    supplier_delivery_note = doc.title,\n    supplier = doc.supplier,\n    company = doc.company,\n    docstatus = 0,\n    posting_date = frappe.utils.nowdate(),\n    posting_time = '00:00:00',\n    set_posting_time = 1,\n    currency = doc.currency,\n    conversion_rate = doc.conversion_rate,\n    disable_rounded_total = 1,\n    buying_price_list = doc.buying_price_list,\n    price_list_currency = doc.price_list_currency,\n    plc_conversion_rate = doc.plc_conversion_rate,\n    set_warehouse = frappe.db.get_value('Stock Settings', 'Stock Settings', 'default_warehouse'),\n    taxes_and_charges = doc.taxes_and_charges,\n    taxes = doc.taxes,\n    apply_discount_on = doc.apply_discount_on,\n    discount_amount = doc.discount_amount,\n    remarks = doc.title,\n    freight_account = doc.freight_account,\n    freight_account_currency = doc.freight_account_currency,\n    freight_amount = doc.freight_amount,\n    freight_exchange_rate = doc.freight_exchange_rate,\n    inspection_account = doc.inspection_account,\n    inspection_account_currency = doc.inspection_account_currency,\n    inspection_amount = doc.inspection_amount,\n    inspection_exchange_rate = doc.inspection_exchange_rate,\n    clearence_account = doc.clearence_account,\n    clearence_amount = doc.clearence_amount,\n    transport_account = doc.transport_account,\n    transport_amount = doc.transport_amount,\n    foreign_banking_charges_account = doc.foreign_banking_charges_account,\n    foreign_banking_charges_account_currency = doc.foreign_banking_charges_account_currency,\n    foreign_banking_charges_amount = doc.foreign_banking_charges_amount,\n    foreign_banking_charges_exchange_rate = doc.foreign_banking_charges_exchange_rate,\n    local_banking_charges_account = doc.local_banking_charges_account,\n    local_banking_charges_amount = doc.local_banking_charges_amount,\n    items = items_to_load\n)).insert(ignore_permissions=True)\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-11-14 10:34:54.450105",
  "module": "Libya Customizations",
  "name": "Auto-Updating Purchase Receipt Management",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Purchase Receipt",
  "script": "for doc in frappe.db.get_list(\"Purchase Receipt\", [[\"docstatus\", \"!=\", 2]]):\n    existing_receipt_name = frappe.db.get_value('Purchase Receipt Management Detail', {'purchase_receipt':doc.name}, 'name')\n    if not existing_receipt_name:\n        frappe.get_doc(dict(\n        doctype = 'Purchase Receipt Management Detail',\n        parent = 'Purchase Receipt Management',\n        parenttype = 'Purchase Receipt Management',\n        parentfield = 'purchase_receipts',\n        purchase_receipt = doc.name,\n        shipment_name = doc.title,\n        total_qty = doc.total_qty,\n        grand_total = doc.grand_total,\n        currency = doc.currency\n    )).insert(ignore_permissions=True)\n    if existing_receipt_name:\n        existing_receipt = frappe.get_doc('Purchase Receipt Management Detail', existing_receipt_name)\n        existing_receipt.update({\n        'purchase_receipt': doc.name,\n        'shipment_name': doc.title,\n        'total_qty': doc.total_qty,\n        'grand_total': doc.grand_total,\n        'currency': doc.currency\n        })\n        existing_receipt.save(ignore_permissions=True)",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-11-11 10:17:40.586136",
  "module": "Libya Customizations",
  "name": "purchse receipt managment add records",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Purchase Receipt Management",
  "script": "for doc in frappe.db.get_list(\"Purchase Receipt\", [[\"docstatus\", \"!=\", 2]], [\"name\", \"title\", \"total_qty\", \"grand_total\", \"currency\", \"posting_date\"], order_by=\"Posting_date Desc\"):\n    existing_receipt_name = frappe.db.get_value('Purchase Receipt Management Detail', {'purchase_receipt':doc.name}, 'name')\n    if not existing_receipt_name:\n        frappe.get_doc(dict(\n        doctype = 'Purchase Receipt Management Detail',\n        parent = 'Purchase Receipt Management',\n        parenttype = 'Purchase Receipt Management',\n        parentfield = 'purchase_receipts',\n        purchase_receipt = doc.name,\n        shipment_name = doc.title,\n        total_qty = doc.total_qty,\n        grand_total = doc.grand_total,\n        currency = doc.currency\n    )).insert(ignore_permissions=True)\n    if existing_receipt_name:\n        existing_receipt = frappe.get_doc('Purchase Receipt Management Detail', existing_receipt_name)\n        existing_receipt.update({\n        'purchase_receipt': doc.name,\n        'shipment_name': doc.title,\n        'total_qty': doc.total_qty,\n        'grand_total': doc.grand_total,\n        'currency': doc.currency,\n        })\n        existing_receipt.save(ignore_permissions=True)",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": "create_dn_from_so",
  "cron_format": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-11-13 17:26:47.576168",
  "module": "Libya Customizations",
  "name": "Creating Delivery Note from Sales Order",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": null,
  "script": "draft_linked_dn = frappe.db.get_list('Delivery Note Item', {'against_sales_order':doc.name, 'docstatus':0}, 'name')\nif draft_linked_dn:\n    frappe.msgprint(msg=_(f\"There is a draft Delivery Note {draft_linked_dn[0]}, please delete or submit it to move forward\"), title=_('Error'), indicator='red') \n    raise frappe.ValidationError\nelse:\n    items_to_load = []\n    for item in doc.items:\n        if item.qty - item.delivered_qty > 0:\n            items_to_load.append({\n                'item_code': item.item_code,\n                'qty': item.qty - item.delivered_qty,\n                'against_sales_order': doc.name,\n                'so_detail':item.name,\n                'warehouse': doc.set_warehouse,\n                'rate': item.rate,\n                'price_list_rate': item.price_list_rate\n            })\n    frappe.get_doc(dict(\n    doctype = 'Delivery Note',\n    customer = doc.customer,\n    company = doc.company,\n    docstatus = 0,\n    posting_date = frappe.utils.nowdate(),\n    posting_time = frappe.utils.nowtime(),\n    set_posting_time = 1,\n    territory = doc.territory,\n    set_warehouse = doc.set_warehouse,\n    selling_price_list = doc.selling_price_list,\n    additional_discount_percentage = doc.additional_discount_percentage,\n    taxes = doc.taxes,\n    sales_team = doc.sales_team,\n    items = items_to_load\n    )).insert(ignore_permissions=True)",
  "script_type": "API"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Submit",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-11-13 13:33:12.838227",
  "module": "Libya Customizations",
  "name": "Overdues Validation in Sales Order",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Order",
  "script": "bypass_overdue_check = frappe.db.get_value('Customer', doc.customer, 'bypass_overdue_check')\nuser_has_cso = frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Chief Sales Officer\"]])\noutstanding = frappe.db.get_value('Sales Invoice', {'docstatus': 1, 'customer': doc.customer, 'posting_date': ['<', frappe.utils.add_days(frappe.utils.nowdate(), - credit_days)]}, 'sum(outstanding_amount)')\noutstanding = outstanding if outstanding else 0\ncredit_days = frappe.db.get_value('Payment Terms Template Detail', {'parent': doc.payment_terms_template}, 'credit_days')\n\nif outstanding > 0 and not (bypass_overdue_check and user_has_cso):\n    frappe.msgprint(msg=_(f\"There are overdue outstandings valued at {outstanding:,f} against the Customer\"), title=_('Error'), indicator='red')\n    raise frappe.ValidationError\nelif outstanding > 0 and (bypass_overdue_check or user_has_cso):\n    frappe.msgprint(msg=_(f\"There are overdue outstandings valued at {outstanding:,f} against the Customer\"), title=_('Warning'), indicator='orange')",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:07.433349",
  "module": "Libya Customizations",
  "name": "Assigning Item Selling Prices Only for Libya Team",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Item Price",
  "script": "if frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Libya Team\"]]):\n    conditions = \"selling=1\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:07.379755",
  "module": "Libya Customizations",
  "name": "Update Accounts In Sales Invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "discount_account = frappe.db.get_value(\"Company\", doc.company, \"default_sales_discount_account\")\nreturn_account = frappe.db.get_value(\"Company\", doc.company, \"default_sales_return_account\")\n\ndoc.additional_discount_account = discount_account\n\nif doc.is_return:\n    for item in doc.items:\n        item.income_account = return_account",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.214228",
  "module": "Libya Customizations",
  "name": "Update Remarks in Sales Invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "delivery_note = doc.items[0].delivery_note\nif doc.is_opening == \"Yes\":\n    doc.remarks = \"فاتورة إفتتاحية\"\nelse:\n    if doc.is_return:\n        doc.remarks = \"فاتورة مردودات آجلة مبيعات\"\n    else:\n        doc.remarks = f\"فاتورة مبيعات آجلة من إذن تسليم رقم {delivery_note}\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:07.278856",
  "module": "Libya Customizations",
  "name": "Filtering Ready Sales Orders for Warehouse User",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Order",
  "script": "if frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Warehouse User\"]]):\n    conditions = \"docstatus=1 AND reservation_status='Reserve with Delivery'AND delivery_status IN ('Not Delivered', 'Partly Delivered')\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:07.169782",
  "module": "Libya Customizations",
  "name": "Filtering Sales Returns for Warehouse User",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "if frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Warehouse User\"]]):\n    conditions = \"docstatus=1 AND is_return=1 AND workflow_state IN ('Pending for Review', 'Return')\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:07.048754",
  "module": "Libya Customizations",
  "name": "Assigning Restrict Account View Only for Libya Team",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Account",
  "script": "if frappe.db.get_value(\"Has Role\", [[\"parent\", \"=\", frappe.session.user], ['role', \"=\", \"Warehouse User\"]]):\n    conditions = \"restrict_account_view='Yes'\"",
  "script_type": "Permission Query"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Submit",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:04.693089",
  "module": "Libya Customizations",
  "name": "Update Payment Status upon submit Sales Invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "if not doc.is_paid and not doc.is_return:\n    doc.payment_status = \"Credit Invoice\"\nelif doc.is_paid and not doc.is_return:\n    doc.payment_status = \"Cash Invoice\"\nelif doc.is_return and not doc.is_paid:\n    doc.payment_status = \"Credit Return\"\nelif doc.is_paid and doc.is_return:\n    doc.payment_status = \"Cash Return\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Cancel",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.342016",
  "module": "Libya Customizations",
  "name": "Update Payment Status upon cancel Sales Invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "doc.payment_status = \"Cancelled\"",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save (Submitted Document)",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2024-12-25 09:27:05.123050",
  "module": "Libya Customizations",
  "name": "Update Payment Status in Sales Invoice (After Submit)",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "if not doc.is_paid and not doc.is_return:\n    doc.payment_status = \"Credit Invoice\"\nelif doc.is_paid and not doc.is_return:\n    doc.payment_status = \"Cash Invoice\"\nelif doc.is_return and not doc.is_paid:\n    doc.payment_status = \"Credit Return\"\nelif doc.is_paid and doc.is_return:\n    doc.payment_status = \"Cash Return\"",
  "script_type": "DocType Event"
 }
]